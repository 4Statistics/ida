<style>@import url(style.css);</style>
[Introduction to Data Analysis](index.html "Course index")

# 8.2. Ordinary least squares

[kenworthy]: http://lanekenworthy.net/2008/02/03/bread-peace-and-the-2008-election/

Linear relationships can be turned into models that provide an estimation of the marginal rate at which a given dependent variable $Y$ changes in function of one or more independent variables $X_1, X_2, ..., X_k$, called the predictors. 

Likewise, the model explored below is unlikely to provide valid forecasts of the fertility rate, but is choice of predictors provides analytical leverage about the effect of literacy and family planning.

<!--
Some of the general ideas that emerge at that stage are:

1. The logic of "ordinary least squares" makes visual as well as statistical sense. The visual idea of OLS is that we are trying to find a way to get a straight line that goes through the data points by coming as close to possible to all of them on average.
2. The extended logic behind that is to make all data points on a scatterplot form a horizontal straight line by using a mathematical transformation of the *y*-axis into a function of the *x*-axis. That is basically what a model does from a visual perspective.
3. Finally, the logic of minimizing the distance between the line and the data points implies that the true result of a model is never the model on its own, but the combination of the line and the data points.

So you can see that a lot about statistical modelling can be translated into visual terms without deviating too much from canonical terminology. Let's take a look at R code to run linear regression models. -->

## Visually weighted regression

Multiple linear regression can be used to [model presidential approval][kenworthy] as a function of economic performance and military casualties. Douglas Hibb's model, which is better known as the "[Bread and Peace][hibbs]" model, performed well in previous elections but badly in the presidential election of 2012. Its explanatory value should not be affected by these considerations, so let's run the model.

```{r hibbs-model, message=FALSE}
# Load packages.
require(downloader)
require(foreign)
data = "data/Hibbs.2012.txt"
# Download the data.
if(!file.exists(data)) {
  file = "data/Hibbs.2012.dta"
	url = "http://www.douglas-hibbs.com/HibbsArticles/HIBBS-OBAMA-FORECAST-27July2012-WEBPOST.dta"
  if(!file.exists(file)) download(url, file, mode = "wb")
  write.csv(read.dta(file), data)
}
# Load the data.
hibbs <- read.csv(data, stringsAsFactors = FALSE)
# Subset to election quarters.
hibbs <- subset(hibbs, !is.na(presvote))
```

```{r vwreg1, eval=FALSE, echo=FALSE, results='hide'}
source("code/vwreg.r")
```

```{r vwreg2, eval=FALSE, echo=FALSE, results='hide'}
# Download the data.
file = "data/qog_basic_cs.txt"
if(!file.exists(file)) {
  message("Downloading the data...")
  # Target file.
	url = "http://www.qog.pol.gu.se/digitalAssets/1373/1373417_qog_basic_cs_csv_120608.csv"
  # Download local copy.
  download(url, file, mode = "wb")
}
# Open local dataset.
qog <- read.csv(file)

p1 <- vwReg(wdi_fr ~ bl_asyf25 + I(bl_asyf25^2), qog, method=lm)

p1 + ylab("Fertility rate") + xlab("Average education years among 25+ year-old females")
```

> __Next__: [Practice](083_practice.html)
