<style>@import url(style.css);</style>
<small>[Introduction to Data Analysis](index.html)</small>

# 5.2. Principal components

Let's continue with our data to perform a principal components analysis.

```{r pca}
# Load original data subset.
load("data/qog_b.Rda")
# Reorder the dataset by fertility rate.
qog_pca <- qog_b[order(qog_b$births), ]
# Store country names in row names.
rownames(qog_pca) <- qog_pca$cname
# Remove country codes and names from the matrix.
qog_pca <- qog_pca[, -c(1:2)]
# Compute principal components from the correlation matrix.
fit <- princomp(qog_pca, cor = TRUE)
```

The next step is to look at the efficacy of each component: the 'screeplot' is a graph of each component, showing how much variance it predicts.

```{r screeplot}
# Screeplot: components below one criterion are not useful for reduction.
plot(fit, type="l")
```

Two components seem useful here. We can plot them together in a 'biplot', for which we need to run another PCA command that uses SVD instead of the correlation matrix to extract the principal components. The biplot shows how observations relate to each variable on each axis.

```{r biplot}
# Compute principal components via SVD.
fit2 <- prcomp(qog_pca, scale = TRUE)
# Biplot.
biplot(fit2)
```

At that stage, we want to take a good look at the components themselves to understand what is going on. The first component, for example, shows that, in our sample, fertility is negatively correlated to the rest of the variables considered. The first two components capture 25% of all variance in the data.

```{r loadings}
# Loadings: principal components decomposed for each variable.
loadings(fit)
```

There are many refinements to the method shown here. The `ClustOfVar` and [FactoMineR](http://factominer.free.fr/) packages, both by French teams, support PCA with missing data as well as [MCA plots](https://gastonsanchez.wordpress.com/2012/10/13/5-functions-to-do-multiple-correspondence-analysis-in-r/), a method that also allows categorical (non-continuous) variables.

> __Next__: [*k*-means](53_kmeans.html).
